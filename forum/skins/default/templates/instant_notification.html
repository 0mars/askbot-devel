{% comment %}
Called from forum.models.__init__.maybe_send_instant_notifications()
Template paramaters:

receiving_user - User
update_author - User
updated_post - Comment|Answer|Question
related_origin_post - origin post related to the update
update_url - absolute url (including http://... to updated post
update_type - question_comment|answer_comment|answer_update|question_update
revision_number - integer (first revision is 1)
has_mention - Boolean 
{% endcomment %}
{% load i18n %} 
{% load smart_if %}
{% blocktrans with receiving_user.get_best_name as user_name %}Dear {{user_name}},{% endblocktrans %}

{% if has_mention %}
{% if update_type == 'question_comment' or update_type == 'answer_comment' %}
{% blocktrans with post_author.get_profile_link as author_link and related_origin_post.get_absolute_url as origin_post_url and related_origin_post.title as origin_post_title %}
{{author_link}} has left you a <a href="{{update_url|safe}}">comment</a>
related to question <a href="{{origin_post_url|safe}}">{{origin_post_title}}</a>
{% endblocktrans %}
{% endif %}
{% else %}{# updated post has no mention of user #}
{% if update_type == 'question_comment' or update_type == 'answer_comment' %}
{% blocktrans with post_author.get_profile_link as author_link and related_origin_post.get_absolute_url as origin_post_url and related_origin_post.title as origin_post_title %}
{{author_link}} has left a new <a href="{{update_url|safe}}">comment</a>
related to question <a href="{{origin_post_url|safe}}">{{origin_post_title}}</a>
{% endblocktrans %}
{% if update
{% endif %}
{% if update_type == 'question_comment' or update_type == 'answer_comment' %}
{% if has_mention %}
{% blocktrans %}

{% endblocktrans %}
{% endif %}
{% endwith %}
{% endif %}
{% if update_type == 'answer_update' %}
{% endif %}
{% if update_type == 'question_update' %}
{% endif %}

{% include "email_footer.txt" %}
