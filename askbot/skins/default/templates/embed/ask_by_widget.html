{% extends "widget_base.html" %}
{% import "macros.html" as macros %}
{% block forestyle %}
  <style type="text/css" media="screen">
    #editor {
      display: block;
      min-height: 200px;
      width: 100%;
      margin: 0;
      border: #CCE6EC 2px solid;
    }

    #id_title{
      width: 100%;
      font-size: 130%;
      border: #CCE6EC 3px solid;
    }

    #submit{
      float: right; 
      font-size: 130%;
    }

    .title{
      font-family: 'Open Sans Condensed', Arial, sans-serif; 
      font-size: 25px;
      margin-bottom: 10px;
    }

    #question-list {
      height: auto;
    }

    #question-list h2{
      text-decoration: none;
      margin: 0px;
      font-size: 13px;
      color: #005580;
      padding: 3px 0 3px 5px;
      margin-left: 15px;
      padding-bottom: 0;
      border-top: #F0F0EC 1px solid;
      border-left: #F0F0EC 1px solid;
      min-height: 30px;
      line-height: 30px;
      font-weight: normal
    }

    #question-list a:hover{
        color: #005580;
        text-decoration: underline;
    }

    #question-list a:visited{
      color: #005580;
      text-decoration: none;
    }

    #question-list span{
      width: 28px;
      height: 26px;
      line-height: 26px;
      text-align: center;
      margin-right: 10px;
      float: left;
      display: block;
      color: white;
      background: #B8D0D5;
      border-radius: 3px;
      -ms-border-radius: 3px;
      -moz-border-radius: 3px;
      -webkit-border-radius: 3px;
      -khtml-border-radius: 3px;
    }
    {{widget.inner_style}}
  </style>
{%endblock%}

{%block body%}
<div class="title">{{widget.title}}</div>
<form action="." method="POST" accept-charset="utf-8">
  {% csrf_token %}
  <label>{%trans%}Please enter a descriptive title for your question{%endtrans%}</label>
  <input autocomplete="off" id="id_title" type="text" name="title" size="70" class='questionTitleInput'>
  {% if related_questions %}
  <div id='question-list'>
  </div>
  {%endif%}
  {{form.text}}
  {% if form.ask_anonymously %}
    <p>{{form.ask_anonymously.label_tag()}}: {{form.ask_anonymously}}</p>
  {%endif%}
  <input type="submit" value="Ask your question" id="submit" />
</form>
{{form.errors}}
{%endblock%}
{% block endjs %}
  <script type='text/javascript' src='{{"/js/live_search_new_thread.js"|media}}'></script>
  <script type="text/javascript" charset="utf-8">
    var minSearchWordLength = {{settings.MIN_SEARCH_WORD_LENGTH}};
    askbot['urls']['api_get_questions'] = '{% url api_get_questions %}';
    liveSearchNewThreadInit();
/*
    var createRelatedDOM = function(data){
      element = $('<div></div>');
      element.attr({class:"question"});
      link = $("<a></a>");
      //link.attr({href:})
      link.text(data.title);
      element.append(link);
      $('.related-questions').append(element);
    };

    $(document).ready(function(){
      $('.related-questions').hide();
      $("#id_title").change(function(){
        data = {query: this.value, _: new Date().getTime()};
        console.log(data);
        $.getJSON("{% url api_get_questions %}", data, function(data){

          console.log('entro');
          if (data.length != 0){
            $('.related-questions').show();
          } else{
            $('.related-questions').hide();
          }

          $.each(data, function(key, value){
            createRelatedDOM(value);
          });
        }); 
      });
        
    });
    */
  </script>
{% endblock %}

